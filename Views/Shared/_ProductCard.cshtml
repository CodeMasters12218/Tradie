@model Tradie.Models.Products.Product

<div class="card">
    <div class="image-container">
        <!-- Image -->
        <img src="@(string.IsNullOrEmpty(Model.ImageUrl) ? Url.Content("~/images/default-product.png") : Model.ImageUrl)" class="card-img-top" alt="@Model.Name">

        <!-- Favorite Button -->
        @{
            var isFavorited = ViewBag.WishlistProductIds != null &&
            ((List<int>)ViewBag.WishlistProductIds).Contains(Model.Id);
        }

        <form asp-controller="Wishlist"
              asp-action="ToggleWishlistItem"
              method="post"
              class="d-inline">
            <input type="hidden" name="productId" value="@Model.Id" />
            <input type="hidden" name="returnUrl" value="@($"{Context.Request.Path}{Context.Request.QueryString}")" />
            <button type="submit"
                    class="favorite-btn btn-sm favorite-btn @(isFavorited ? "favorited" : "")"
                    onclick="toggleHeart(this)">
                <i class="bi @(isFavorited ? "bi-heart-fill" : "bi-heart")"></i>
            </button>
        </form>
    </div>

    <!-- Card Body -->
    <div class="card-body">
        <h5 class="card-title">@Model.Name</h5>
        <p class="card-text"> @Model.Description</p>
        <h5 class="card-price">@Model.Price</h5>

        <!-- Add to Cart -->
        <button class="cart-button" onclick="toggleCartHome(this)">
            Añadir a la cesta <i class="bi bi-cart"></i>
        </button>
    </div>
</div>